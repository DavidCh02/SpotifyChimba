<!-- app/templates/admin.html -->

{% extends "base.html" %}

{% block content %}
<section class="admin">
    <h2>Panel de Administración</h2>
    <h3>Agregar Artista</h3>
    <form method="POST" action="{{ url_for('main.admin') }}">
        <input type="hidden" name="add_artist">
        <label for="nombre">Nombre:</label>
        <input type="text" id="nombre" name="nombre" required>
        <button type="submit">Agregar Artista</button>
    </form>

    <h3>Agregar Álbum</h3>
    <form method="POST" action="{{ url_for('main.admin') }}">
        <input type="hidden" name="add_album">
        <label for="titulo">Título:</label>
        <input type="text" id="titulo" name="titulo" required>
        <label for="id_artista">Artista:</label>
        <select id="id_artista" name="id_artista" required>
            {% for artista in artistas %}
                <option value="{{ artista.id_artista }}">{{ artista.nombre }}</option>
            {% endfor %}
        </select>
        <button type="submit">Agregar Álbum</button>
    </form>

    <h3>Subir Canción</h3>
    <form method="POST" action="{{ url_for('main.admin') }}" enctype="multipart/form-data">
        <input type="hidden" name="upload_song">
        <label for="titulo">Título:</label>
        <input type="text" id="titulo" name="titulo" required>
        <label for="id_artista">Artista:</label>
        <select id="id_artista" name="id_artista" required>
            {% for artista in artistas %}
                <option value="{{ artista.id_artista }}">{{ artista.nombre }}</option>
            {% endfor %}
        </select>
        <label for="id_album">Álbum:</label>
        <select id="id_album" name="id_album" required>
            {% for album in albumes %}
                <option value="{{ album.id_album }}">{{ album.titulo }}</option>
            {% endfor %}
        </select>
        <label for="archivo">Archivo de Audio:</label>
        <input type="file" id="archivo" name="archivo" accept="audio/*" required>
        <button type="submit">Subir Canción</button>
    </form>

    <h3>Canciones</h3>
    <ul>
        {% for cancion in canciones %}
            <li>
                {{ cancion.titulo }} - {{ cancion.artista.nombre }} - {{ cancion.album.titulo }} - {{ cancion.duracion }} segundos
                <audio controls>
                    <source src="{{ url_for('static', filename='uploads/' ~ cancion.archivo) }}" type="audio/mpeg">
                    Tu navegador no soporta la reproducción de audio.
                </audio>
                <form method="POST" action="{{ url_for('main.delete_song', id_cancion=cancion.id_cancion) }}">
                    <button type="submit">Eliminar</button>
                </form>
                <a href="{{ url_for('main.edit_song', id_cancion=cancion.id_cancion) }}">Editar</a>
            </li>
        {% endfor %}
    </ul>
</section>
{% endblock %}